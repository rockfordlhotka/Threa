@using GameMechanics.GamePlay
@using Threa.Dal.Dto

<div class="hidden-npc-card p-2 rounded border d-flex justify-content-between align-items-center"
     style="background: var(--color-bg-secondary); cursor: pointer;"
     @onclick="HandleClick">
    <div class="d-flex align-items-center gap-2">
        <i class="bi bi-eye-slash text-muted"></i>
        <span class="small">@Character.CharacterName</span>
        @* Disposition indicator *@
        @switch (Character.Disposition)
        {
            case NpcDisposition.Hostile:
                <i class="bi bi-skull text-danger small"></i>
                break;
            case NpcDisposition.Neutral:
                <i class="bi bi-circle text-secondary small"></i>
                break;
            case NpcDisposition.Friendly:
                <i class="bi bi-heart text-success small"></i>
                break;
        }
    </div>
    <button class="btn btn-outline-success btn-sm"
            title="Reveal to players"
            @onclick:stopPropagation="true"
            @onclick="HandleReveal">
        <i class="bi bi-eye"></i>
    </button>
</div>

@code {
    [Parameter, EditorRequired]
    public TableCharacterInfo Character { get; set; } = null!;

    [Parameter]
    public EventCallback<TableCharacterInfo> OnReveal { get; set; }

    [Parameter]
    public EventCallback<TableCharacterInfo> OnClick { get; set; }

    private async Task HandleReveal()
    {
        await OnReveal.InvokeAsync(Character);
    }

    private async Task HandleClick()
    {
        await OnClick.InvokeAsync(Character);
    }
}
