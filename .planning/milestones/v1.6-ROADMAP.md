# Milestone v1.6: Batch Character Actions

**Status:** SHIPPED 2026-02-05
**Phases:** 28-31
**Total Plans:** 9

## Overview

Enable GMs to select multiple characters (NPCs and/or PCs) and apply actions to all at once for efficient encounter management. Includes multi-select checkboxes, batch damage/healing, batch visibility toggle, batch dismiss/archive, and batch effect add/remove with clear partial-success feedback.

## Phases

### Phase 28: Selection Infrastructure

**Goal**: GMs can select multiple characters from the dashboard with clear visual feedback
**Depends on**: Phase 27 (v1.5 shipped)
**Requirements**: SEL-01, SEL-02, SEL-03, SEL-04, SEL-05
**Success Criteria**:
  1. GM can click checkbox on any character status card to toggle selection
  2. Dashboard displays "X selected" count when characters are selected
  3. GM can click "Select All" to select all characters within a section
  4. GM can click "Deselect All" to clear all selections
  5. Selected characters have visible highlight/indicator
**Plans**: 2 plans

Plans:
- [x] 28-01-PLAN.md - Selection state management and checkbox UI on all card components
- [x] 28-02-PLAN.md - Selection controls (SelectionBar, per-section Select All, Escape key handler)

### Phase 29: Batch Action Framework

**Goal**: GMs can apply damage or healing to all selected characters at once with clear feedback
**Depends on**: Phase 28
**Requirements**: DMG-01, DMG-02, DMG-03, DMG-04, UX-01, UX-02, UX-03, UX-04
**Success Criteria**:
  1. Contextual action bar appears when one or more characters are selected
  2. GM can enter damage amount and apply to all selected characters in one action
  3. GM can enter healing amount and apply to all selected characters in one action
  4. Batch results show success count
  5. When some characters fail, feedback shows both successes and failures with reasons
**Plans**: 3 plans

Plans:
- [x] 29-01-PLAN.md - BatchActionService backend with sequential processing
- [x] 29-02-PLAN.md - SelectionBar action buttons and damage/healing modal
- [x] 29-03-PLAN.md - Result feedback display and selection cleanup

### Phase 30: Batch Visibility & Lifecycle

**Goal**: GMs can toggle visibility or dismiss/archive multiple NPCs at once
**Depends on**: Phase 29
**Requirements**: VIS-01, VIS-02, LIFE-01, LIFE-02
**Success Criteria**:
  1. GM can reveal or hide all selected NPCs in one action
  2. GM can dismiss/archive all selected NPCs in one action
  3. Visibility batch shows success/failure feedback
  4. Dismiss batch shows success/failure feedback
**Plans**: 2 plans

Plans:
- [x] 30-01-PLAN.md - Backend: extend BatchActionService with visibility toggle and dismiss methods
- [x] 30-02-PLAN.md - Frontend: SelectionBar visibility/dismiss buttons, confirmation modal, GmTable wiring

### Phase 31: Batch Effects

**Goal**: GMs can add or remove effects to/from multiple characters at once
**Depends on**: Phase 30
**Requirements**: EFF-01, EFF-02, EFF-03
**Success Criteria**:
  1. GM can select an effect from the effect picker and add it to all selected characters
  2. GM can select an effect type and remove it from all selected characters that have it
  3. Effect batch operations show success count and any failures with reasons
**Plans**: 2 plans

Plans:
- [x] 31-01-PLAN.md - Backend effect add service + BatchEffectAddModal + SelectionBar wiring
- [x] 31-02-PLAN.md - Backend effect remove service + BatchEffectRemoveModal + SelectionBar wiring

## Progress

| Phase | Plans Complete | Status | Completed |
|-------|----------------|--------|-----------|
| 28. Selection Infrastructure | 2/2 | Complete | 2026-02-04 |
| 29. Batch Action Framework | 3/3 | Complete | 2026-02-05 |
| 30. Batch Visibility & Lifecycle | 2/2 | Complete | 2026-02-05 |
| 31. Batch Effects | 2/2 | Complete | 2026-02-05 |

---

## Milestone Summary

**Key Decisions:**
- HashSet<int> for O(1) selection state (component-level in GmTable)
- Sequential batch processing (mirrors TimeAdvancementService, CSLA objects not thread-safe)
- Single CharactersUpdatedMessage after batch completes (prevents N refresh cycles)
- BatchActionRequest as record type for 'with' expression support
- Two-layer NPC protection (UI pre-filter + service-level skip)
- Action-type-aware selection cleanup (clear on damage/heal, preserve on visibility/effects, remove dismissed on dismiss)
- Shared game timestamp from first character for batch effect consistency
- Name-based effect removal (not ID-based) for cross-character matching

**Issues Resolved:**
- None â€” clean implementation across all phases

**Issues Deferred:**
- None

**Technical Debt Incurred:**
- None

---

_For current project status, see .planning/ROADMAP.md_
