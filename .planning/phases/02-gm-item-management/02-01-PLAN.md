---
phase: 02-gm-item-management
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - Threa.Dal/Dto/ItemTemplate.cs
  - GameMechanics/Items/ItemTemplateEdit.cs
  - GameMechanics/Items/ItemTemplateInfo.cs
  - Threa.Dal.MockDb/ItemTemplateDal.cs
  - Threa.Dal.MockDb/MockDb.cs
autonomous: true

must_haves:
  truths:
    - "Tags property exists on ItemTemplate DTO"
    - "Tags can be saved and loaded via business object"
    - "Tags appear in ItemTemplateInfo for list display"
    - "Existing item templates in MockDb have sample tags"
  artifacts:
    - path: "Threa.Dal/Dto/ItemTemplate.cs"
      provides: "Tags property on DTO"
      contains: "public string? Tags"
    - path: "GameMechanics/Items/ItemTemplateEdit.cs"
      provides: "Tags property with CSLA pattern"
      contains: "TagsProperty"
    - path: "GameMechanics/Items/ItemTemplateInfo.cs"
      provides: "Tags for read-only display"
      contains: "TagsProperty"
  key_links:
    - from: "ItemTemplateEdit.cs"
      to: "ItemTemplate.cs"
      via: "LoadFromDto and Insert/Update methods"
      pattern: "Tags = (dto\\.Tags|Tags)"
---

<objective>
Add Tags property to the item template data layer for categorization and filtering.

Purpose: Enable GMs to tag items with custom categories (e.g., "starter-gear", "magical", "ranged") for easier organization and filtering. This is a prerequisite for Plan 03's tag filtering UI.

Output: Tags property added to DTO, ItemTemplateEdit, and ItemTemplateInfo; MockDb seed data updated with sample tags.
</objective>

<execution_context>
@C:\Users\rocky\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\rocky\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-gm-item-management/02-CONTEXT.md
@.planning/phases/02-gm-item-management/02-RESEARCH.md

# Phase 1 established patterns
@.planning/phases/01-foundation/01-01-SUMMARY.md
@.planning/phases/01-foundation/01-02-SUMMARY.md

# Existing files to modify
@Threa.Dal/Dto/ItemTemplate.cs
@GameMechanics/Items/ItemTemplateEdit.cs
@GameMechanics/Items/ItemTemplateInfo.cs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Tags property to DTO and business objects</name>
  <files>
    Threa.Dal/Dto/ItemTemplate.cs
    GameMechanics/Items/ItemTemplateEdit.cs
    GameMechanics/Items/ItemTemplateInfo.cs
  </files>
  <action>
Add Tags property to the item template data layer:

1. **ItemTemplate.cs (DTO)** - Add after IsActive property:
   ```csharp
   /// <summary>
   /// Comma-separated list of custom tags for categorization.
   /// </summary>
   public string? Tags { get; set; }
   ```

2. **ItemTemplateEdit.cs** - Add CSLA property following existing pattern:
   - Add PropertyInfo and property (after IsActive, around line 120)
   - Add to LoadFromDto method
   - Add to Insert and Update DTO construction
   - Pattern: `public static readonly PropertyInfo<string?> TagsProperty = RegisterProperty<string?>(nameof(Tags));`

3. **ItemTemplateInfo.cs** - Add read-only property:
   - Add PropertyInfo and property (after IsActive)
   - Add to Fetch method and LoadFromDto method
   - Pattern matches existing properties like ShortDescription

Tags are stored as comma-separated string (e.g., "starter-gear,melee,common"). This simple format is sufficient for v1 - no separate tags table needed.
  </action>
  <verify>
    dotnet build Threa.sln
  </verify>
  <done>
    Tags property exists on ItemTemplate DTO, ItemTemplateEdit (with SetProperty), and ItemTemplateInfo (read-only).
  </done>
</task>

<task type="auto">
  <name>Task 2: Update MockDb seed data with sample tags</name>
  <files>
    Threa.Dal.MockDb/MockDb.cs
  </files>
  <action>
Add Tags to existing seed data items in MockDb.cs. Add meaningful tags to help demonstrate filtering:

**Melee weapons:** Tags = "melee,starter-gear"
- Longsword, Short Sword, Dagger, Battle Axe, Mace, War Spear

**Ranged weapons:** Tags = "ranged,starter-gear"
- Longbow, Heavy Crossbow, Throwing Knives

**Firearms:** Tags = "ranged,firearm,modern"
- Combat Pistol, Assault Rifle, Combat Shotgun, Compact SMG, Laser Pistol

**Armor:** Tags = "armor,starter-gear"
- Leather Helmet, Chainmail Shirt, Shield (Buckler), Shield (Heater), Shield (Tower), Leather Armor

**Containers:** Tags = "container,utility"
- Backpack, Belt Pouch, Quiver, Bandolier, Holster

**Ammunition:** Tags = "ammunition"
- Arrow, Bolt, 9mm Parabellum, 5.56mm NATO, 12 Gauge Buckshot, 12 Gauge Slug, Power Cell

**Consumables:** Tags = "consumable"
- Health Potion, Frag Grenade

Find each item in the ItemTemplates list and add the Tags property.
  </action>
  <verify>
    dotnet build Threa.sln && dotnet test GameMechanics.Test/GameMechanics.Test.csproj --filter "FullyQualifiedName~ItemTemplateTests"
  </verify>
  <done>
    All 52 seed items have appropriate Tags assigned. Existing tests still pass.
  </done>
</task>

</tasks>

<verification>
1. `dotnet build Threa.sln` - No compilation errors
2. `dotnet test GameMechanics.Test/GameMechanics.Test.csproj --filter "FullyQualifiedName~ItemTemplateTests"` - All existing tests pass
3. Manual verification: Tags property visible in ItemTemplateEdit, ItemTemplateInfo, and ItemTemplate DTO
</verification>

<success_criteria>
- Tags property added to ItemTemplate DTO with XML documentation
- Tags property added to ItemTemplateEdit with proper CSLA PropertyInfo pattern
- Tags property added to ItemTemplateInfo for read-only access
- LoadFromDto and DTO construction in ItemTemplateEdit include Tags
- MockDb seed data items have Tags assigned
- All existing ItemTemplate tests continue to pass
- Solution builds without errors
</success_criteria>

<output>
After completion, create `.planning/phases/02-gm-item-management/02-01-SUMMARY.md`
</output>
